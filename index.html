<!DOCTYPE html>
<html>
<body>

<h2 align="center">Address Search</h2>

<P>
   <input type="checkbox" id="usa" name="usa" class="form-control" onclick="set_text_input()"><label for="usa">USA</label>
   <input type="checkbox" id="india" name="india" class="form-control" onclick="set_text_input()"><label for="usa">India</label>
   <input type="checkbox" id="spain" name="spain" class="form-control" onclick="set_text_input()"><label for="usa">Spain</label>
   <input type="checkbox" id="japan" name="japan" class="form-control" onclick="set_text_input()"><label for="usa">Japan</label>
   <input type="checkbox" id="germany" name="germany" class="form-control" onclick="set_text_input()"><label for="usa">Germany</label>
   <input type="checkbox" id="canada" name="canada" class="form-control" onclick="set_text_input()"><label for="usa">Canada</label><br>
   <input type="checkbox" id="southkorea" name="southkorea" class="form-control" onclick="set_text_input()"><label for="usa">South Korea</label>
   <input type="checkbox" id="northkorea" name="northkorea" class="form-control" onclick="set_text_input()"><label for="usa">North Korea</label>
   <input type="checkbox" id="brazil" name="brazil" class="form-control" onclick="set_text_input()"><label for="usa">Brazil</label>
   <input type="checkbox" id="uk" name="uk" class="form-control" onclick="set_text_input()"><label for="usa">UK</label>
   <input type="checkbox" id="mexico" name="mexico" class="form-control" onclick="set_text_input()"><label for="usa">Mexico</label><br>
 </P>

<form id="myForm">
  <h2>Select a country(ies):</h2>


  <h2>Provide a name:</h2>
  <p>
    First Name: <input id="First Name" name="First Name" style=" width: 10%" type="text" placeholder="" autocomplete="off">
    Last Name: <input id="Last Name" name="Last Name" style=" width: 10%" type="text" placeholder="" autocomplete="off">
  </p>

  <h2>Provide a partial address(es)</h2>
  <P>
    State: <input id="State" name="State" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Province: <input id="Province" name="Province" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Prefecture: <input id="Prefecture" name="Prefecture" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    City: <input id="City" name="City" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Locality: <input id="Locality" name="Locality" style=" width: 10%" type="text" autocomplete="off" disabled="true"><br>
    Town: <input id="Town" name="Town" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Village: <input id="Village" name="Village" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Subdivision: <input id="Subdivision" name="Subdivision" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Sector: <input id="Sector" name="Sector" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Quadrant: <input id="Quadrant" name="Quadrant" style=" width: 10%" type="text" autocomplete="off" disabled="true"><br>
    Block: <input id="Block" name="Block" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Neighborhood: <input id="Neighborhood" name="Neighborhood" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Quarter: <input id="Quarter" name="Quarter" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Street: <input id="Street" name="Street" style=" width: 10%" type="text" autocomplete="off" disabled="true"><br>
    Building/House No: <input id="BuildingHouseNo" name="BuildingHouseNo" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Apt/Suite: <input id="AptSuite" name="AptSuite" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    Zip: <input id="Zip" name="Zip" style=" width: 10%" type="text" autocomplete="off" disabled="true">
    POB: <input id="POB" name="POB" style=" width: 10%" type="text" autocomplete="off" disabled="true">
  </P>
  <button onclick="submitForm()" class="btn btn-info">Search</button>
  <input type="hidden" id="searchCountries" name="searchCountries" value="">
</form>

<div class="results">
  <p class="result-json-output"></p>
</div>

<script type="text/javascript">
  function merge_array(res, country){
    for (const element of country) {
        res.push(element);
    }
  }
  function set_text_input() {

    const usa = ["State", "City", "Street", "BuildingHouseNo", "AptSuite", "Zip", "POB"];
    const india = ["City", "Town", "Locality", "Street", "Zip"];
    const spain = ["City", "Town", "Street", "Zip", "BuildingHouseNo"];
    const japan = ["Prefecture", "City", "Town", "Street", "Zip"];
    const germany = ["City", "Town", "Street", "Zip", "POB"];
    const southkorea = ["Province", "City", "Subdivision", "BuildingHouseNo"];
    const northkorea = ["Province", "City", "Street", "BuildingHouseNo"];
    const brazil = ["Province", "City", "Sector", "Block", "Quadrant", "Neighborhood", "Street", "BuildingHouseNo", "Zip", "POB"];
    const uk = ["City", "Town", "Street", "Zip"];
    const mexico = ["State", "Province", "City", "Locality", "Village", "Neighborhood", "Quarter", "Street", "Zip", "BuildingHouseNo", "AptSuite"];
    const canada = ["Province", "City", "Street", "AptSuite", "Zip"];

    var selectUSA = document.getElementById('usa').checked;
    var selectIndia = document.getElementById('india').checked;
    var selectSpain = document.getElementById('spain').checked;
    var selectJapan = document.getElementById('japan').checked;
    var selectGermany = document.getElementById('germany').checked;
    var selectSKorea = document.getElementById('southkorea').checked;
    var selectNKorea = document.getElementById('northkorea').checked;
    var selectBrazil = document.getElementById('brazil').checked;
    var selectUK = document.getElementById('uk').checked;
    var selectMexico = document.getElementById('mexico').checked;
    var selectCanada = document.getElementById('canada').checked;

    const res = []

    if(selectUSA){
      merge_array(res, usa);
    }
    if(selectIndia){
      merge_array(res, india);
    }
    if(selectSpain){
      merge_array(res, spain);
    }
    if(selectJapan){
      merge_array(res, japan);
    }
    if(selectGermany){
      merge_array(res, germany);
    }
    if(selectSKorea){
      merge_array(res, southkorea);
    }
    if(selectNKorea){
      merge_array(res, northkorea);
    }
    if(selectBrazil){
      merge_array(res, brazil);
    }
    if(selectUK){
      merge_array(res, uk);
    }
    if(selectMexico){
      merge_array(res, mexico);
    }
    if(selectCanada){
      merge_array(res, canada);
    }

    var set = new Set(res)

    if(set.has("Street")){
      Street.disabled = false;
    }else{
      Street.disabled = true;
    }
    if(set.has("BuildingHouseNo")){
      BuildingHouseNo.disabled = false;
    }else{
      BuildingHouseNo.disabled = true;
    }
    if(set.has("Zip")){
      Zip.disabled = false;
    }else{
      Zip.disabled = true;
    }
    if(set.has("Quarter")){
      Quarter.disabled = false;
    }else{
      Quarter.disabled = true;
    }
    if(set.has("Town")){
      Town.disabled = false;
    }else{
      Town.disabled = true;
    }
    if(set.has("Neighborhood")){
      Neighborhood.disabled = false;
    }else{
      Neighborhood.disabled = true;
    }
    if(set.has("Block")){
      Block.disabled = false;
    }else{
      Block.disabled = true;
    }
    if(set.has("Village")){
      Village.disabled = false;
    }else{
      Village.disabled = true;
    }
    if(set.has("AptSuite")){
      AptSuite.disabled = false;
    }else{
      AptSuite.disabled = true;
    }
    if(set.has("State")){
      State.disabled = false;
    }else{
      State.disabled = true;
    }
    if(set.has("Sector")){
      Sector.disabled = false;
    }else{
      Sector.disabled = true;
    }
    if(set.has("Province")){
      Province.disabled = false;
    }else{
      Province.disabled = true;
    }
    if(set.has("POB")){
      POB.disabled = false;
    }else{
      POB.disabled = true;
    }
    if(set.has("City")){
      City.disabled = false;
    }else{
      City.disabled = true;
    }
    if(set.has("Subdivision")){
      Subdivision.disabled = false;
    }else{
      Subdivision.disabled = true;
    }
    if(set.has("Locality")){
      Locality.disabled = false;
    }else{
      Locality.disabled = true;
    }
    if(set.has("Quadrant")){
      Quadrant.disabled = false;
    }else{
      Quadrant.disabled = true;
    }
    if(set.has("Prefecture")){
      Prefecture.disabled = false;
    }else{
      Prefecture.disabled = true;
    }
  }


  function submitForm(){

  var firstName = document.getElementById("First Name").value
  var LastName = document.getElementById("Last Name").value
  var Street = document.getElementById("Street").value
  var BuildingHouseNo = document.getElementById("BuildingHouseNo").value
  var Zip = document.getElementById("Zip").value
  var Quarter = document.getElementById("Quarter").value
  var Town = document.getElementById("Town").value
  var Neighborhood = document.getElementById("Neighborhood").value
  var Block = document.getElementById("Block").value
  var Village = document.getElementById("Village").value
  var AptSuite = document.getElementById("AptSuite").value
  var State = document.getElementById("State").value
  var Sector = document.getElementById("Sector").value
  var Province = document.getElementById("Province").value
  var POB = document.getElementById("POB").value
  var City = document.getElementById("City").value
  var Subdivision = document.getElementById("Subdivision").value
  var Locality = document.getElementById("Locality").value
  var Quadrant = document.getElementById("Quadrant").value
  var Prefecture = document.getElementById("Prefecture").value

  var selectUSA = document.getElementById('usa').checked;
  var selectIndia = document.getElementById('india').checked;
  var selectSpain = document.getElementById('spain').checked;
  var selectJapan = document.getElementById('japan').checked;
  var selectGermany = document.getElementById('germany').checked;
  var selectSKorea = document.getElementById('southkorea').checked;
  var selectNKorea = document.getElementById('northkorea').checked;
  var selectBrazil = document.getElementById('brazil').checked;
  var selectUK = document.getElementById('uk').checked;
  var selectMexico = document.getElementById('mexico').checked;
  var selectCanada = document.getElementById('canada').checked;

  var res = []
  var searchCountries = ""

  if(selectUSA) res.push("usa")
  if(selectIndia) res.push("india")
  if(selectSpain) res.push("spain")
  if(selectJapan) res.push("japan")
  if(selectGermany) res.push("germany")
  if(selectSKorea) res.push("southkorea")
  if(selectNKorea) res.push("northkorea")
  if(selectBrazil) res.push("brazil")
  if(selectUK) res.push("uk")
  if(selectMexico) res.push("mexico")
  if(selectCanada) res.push("canada")


  for (let i = 0; i < res.length; i++){
    if (i == res.length - 1){
      searchCountries += res[i];
    }
    else searchCountries += res[i] + " ";
  }

  document.getElementById('searchCountries').value = searchCountries;


  const jsonTest = {"searchCountries" : searchCountries, "First Name" : firstName, "Last Name" : LastName, "Street" : Street,
  "BuildingHouseNo" : BuildingHouseNo, "Zip" : Zip, "Quarter" : Quarter, "Town" : Town, "Neighborhood" : Neighborhood, "Block" : Block,
  "Village" : Village, "AptSuite" : AptSuite, "State" : State, "Sector" : Sector, "Province" : Province, "POB" : POB,
  "City" : City, "Subdivision" : Subdivision, "Locality" : Locality, "Quadrant" : Quadrant, "Prefecture" : Prefecture}


  const myJSON =  JSON.stringify(jsonTest);

  const myForm = document.getElementById("myForm");

  myForm.addEventListener("submit",function(e){
     e.preventDefault();

     const formData = new FormData(this);

     fetch("https://address-search.azurewebsites.net/api/addresssearch",{
        method:"POST",
        body:myJSON,
        mode: 'no-cors'
     })
     .then(function(response){
        return response.json;
     })
     .then(function (json){
        console.log(json);
     })
     .catch(function(error){
        console.error(error);
     })
  })


}

</script>

</body>
</html>